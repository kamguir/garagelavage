<?php

/**
 * Skeleton subclass for representing a row from the 'tbl_tapis' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.6.6-dev on:
 *
 * 11/27/13 15:56:17
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    propel.generator.lib.model
 */
class TblTapis extends BaseTblTapis {

    public function getMontantTotalTapisParDate($date) {
        $jour = date('d');
        $mois = date('m');
        $annee = date('Y');
        if ($date == $jour) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $jour;
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $mois;
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        }
        if ($date == $mois) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 31';
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $mois;
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        }
        if ($date == $annee) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 31';
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 12';
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        }

        return (double) TblTapisQuery::create()
                        ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $jourCourant, Criteria::CUSTOM)
                        ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $moisCourant, Criteria::CUSTOM)
                        ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $anneeCourante, Criteria::CUSTOM)
                        ->withColumn('SUM(' . TblTapisPeer::MONTANT_LAVAGE_TAPIS . ')', "montantTotalTapis")
                        ->select('montantTotalTapis')
                        ->findOne();
        echo Propel::getConnection()->getLastExecutedQuery();
        die;
    }

    public function getNbrTapisParDate($date) {
        $jour = date('d');
        $mois = date('m');
        $annee = date('Y');
        if ($date == $jour) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $jour;
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $mois;
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        } if ($date == $mois) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 31';
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $mois;
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        } if ($date == $annee) {
            $jourCourant = 'DAY(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 31';
            $moisCourant = 'MONTH(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')between 1 and 12';
            $anneeCourante = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . $annee;
        }
        return $nbrVoitures = TblTapisQuery::create()
                ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $jourCourant, Criteria::CUSTOM)
                ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $moisCourant, Criteria::CUSTOM)
                ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $anneeCourante, Criteria::CUSTOM)
                ->count();

        echo Propel::getConnection()->getLastExecutedQuery();
        die;
    }

    public function getNbrTapisParWeek() {
        $weekAcctuel = 'WEEK(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=WEEK(CURDATE())';
        $anneeAcctuelle = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . date('Y');
        return $nbrVoitures = TblTapisQuery::create()
                ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $weekAcctuel, Criteria::CUSTOM)
                ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $anneeAcctuelle, Criteria::CUSTOM)
                ->count();
    }

    public function getMontantTotalParWeek() {
        $weekAcctuel = 'WEEK(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=WEEK(CURDATE())';
        $anneeAcctuelle = 'YEAR(' . TblTapisPeer::DATE_LAVAGE_TAPIS . ')=' . date('Y');

        return (double) TblTapisQuery::create()
                        ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $weekAcctuel, Criteria::CUSTOM)
                        ->addAnd(TblTapisPeer::DATE_LAVAGE_TAPIS, $anneeAcctuelle, Criteria::CUSTOM)
                        ->withColumn('SUM(' . TblTapisPeer::MONTANT_LAVAGE_TAPIS . ')', "montantTotal")
                        ->select('montantTotal')
                        ->findOne();
        echo Propel::getConnection()->getLastExecutedQuery();
        die;
    }
}

// TblTapis
